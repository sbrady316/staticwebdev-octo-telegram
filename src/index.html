<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <title>Vanilla JavaScript App</title>
</head>
<body>
  <script>
    async function getUserInfo() {
      const response = await fetch('/.auth/me');
      console.log(`getUserInfo():response = ${response}`);
      const payload = await response.json();
      console.log(`getUserInfo():payload = ${payload}`);
      console.log(`payload.userDetails = ${payload.userDetails}`);
      const { clientPrincipal } = payload;
      console.log(`getUserInfo():clientPrincipal = ${clientPrincipal}`);
      return clientPrincipal;
    }

    function getUserInfo2() {
      fetch('/.auth/me')
      .then(r => r.text())
      .then(t => console.log(t));
    }

    // Do I need this?
    cp = getUserInfo().then(cp => cp);
    console.log(cp);
    document.body.innerHTML = "<p>You are " + cp + "</p>"
    getUserInfo2();
  </script>
  <main>
    <h1>Authenticator 5000</h1>
  </main>
</body>

</html>
